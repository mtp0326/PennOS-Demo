\doxysection{src/util/pennfat\+\_\+kernel.c File Reference}
\hypertarget{pennfat__kernel_8c}{}\label{pennfat__kernel_8c}\index{src/util/pennfat\_kernel.c@{src/util/pennfat\_kernel.c}}
{\ttfamily \#include "{}pennfat\+\_\+kernel.\+h"{}}\newline
{\ttfamily \#include "{}unistd.\+h"{}}\newline
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{pennfat__kernel_8c_a2620b333236d4362345a3eaa15479aa5}{zero\+\_\+out\+\_\+helper}} (int curr)
\item 
int \mbox{\hyperlink{pennfat__kernel_8c_a4d2cf4232cddee738996ca9ad83ea56f}{k\+\_\+open}} (const char \texorpdfstring{$\ast$}{*}fname, int mode)
\begin{DoxyCompactList}\small\item\em Open file name {\ttfamily fname} with the mode {\ttfamily mode}, and return a file descriptor to that file. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{pennfat__kernel_8c_ada30dc78055b7b113ff2dac9aabe4eb3}{is\+\_\+file\+\_\+name\+\_\+valid}} (char \texorpdfstring{$\ast$}{*}name)
\begin{DoxyCompactList}\small\item\em Checks whether the filename follows the POSIX standard. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structdirectory__entries}{directory\+\_\+entries}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{pennfat__kernel_8c_a78d95341bbd2b21ed69dd341ff47669f}{does\+\_\+file\+\_\+exist}} (const char \texorpdfstring{$\ast$}{*}fname)
\begin{DoxyCompactList}\small\item\em helper that traverses root directory block by block to check if fname file exists return\+: the directory entry struct with name fname (NULL if not found) also moves fs\+\_\+fd to the end of the root directory \end{DoxyCompactList}\item 
void \mbox{\hyperlink{pennfat__kernel_8c_a6532ad36b852dd09d641bcaac2642b9b}{move\+\_\+to\+\_\+open\+\_\+de}} (bool found)
\begin{DoxyCompactList}\small\item\em Change the offset to the fs\+\_\+fd to the first open directory entry. \end{DoxyCompactList}\item 
off\+\_\+t \mbox{\hyperlink{pennfat__kernel_8c_a8434cdce67b1512300f44ed38497c22a}{does\+\_\+file\+\_\+exist2}} (const char \texorpdfstring{$\ast$}{*}fname)
\begin{DoxyCompactList}\small\item\em Helper function that given a files name, it outputs the offset to the directory entry or negative number if the file isn\textquotesingle{}t found. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{pennfat__kernel_8c_addbc36d23ce41b02cb1508bf85ca24e2}{get\+\_\+first\+\_\+empty\+\_\+fat\+\_\+index}} ()
\begin{DoxyCompactList}\small\item\em Finds and returns the first empty fat index marked as 0x0000. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{pennfat__kernel_8c_a2d501c304eeba5035c83c1e2a4aec4fb}{lseek\+\_\+to\+\_\+root\+\_\+directory}} ()
\begin{DoxyCompactList}\small\item\em lseek the file system\textquotesingle{}s offset to the start of the root directory. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structfile__descriptor__st}{file\+\_\+descriptor\+\_\+st}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{pennfat__kernel_8c_abe5ffc180d9fc063efc7127d14378b54}{get\+\_\+file\+\_\+descriptor}} (int fd)
\begin{DoxyCompactList}\small\item\em Return the file descriptor struct for the given file descriptor number. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structfile__descriptor__st}{file\+\_\+descriptor\+\_\+st}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{pennfat__kernel_8c_a25ad4d01d5ade905b2bfce04910a5c0d}{create\+\_\+file\+\_\+descriptor}} (int fd, char \texorpdfstring{$\ast$}{*}fname, int mode, int offset)
\begin{DoxyCompactList}\small\item\em Creates a new \doxylink{structfile__descriptor__st}{file\+\_\+descriptor\+\_\+st} struct, initialized with the values provided by the parameters. For more information of the parameters, refer to struct \doxylink{structfile__descriptor__st}{file\+\_\+descriptor\+\_\+st}. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structdirectory__entries}{directory\+\_\+entries}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{pennfat__kernel_8c_a3fd2d5dba8f5f42be13d549b0e08a3ad}{create\+\_\+directory\+\_\+entry}} (const char \texorpdfstring{$\ast$}{*}name, uint32\+\_\+t size, uint16\+\_\+t first\+Block, uint8\+\_\+t type, uint8\+\_\+t perm, time\+\_\+t mtime)
\begin{DoxyCompactList}\small\item\em Creates a new \doxylink{structdirectory__entries}{directory\+\_\+entries} struct, initialized with the values provided by the parameters. For more information of the parameters, refer to struct \doxylink{structdirectory__entries}{directory\+\_\+entries}. \end{DoxyCompactList}\item 
ssize\+\_\+t \mbox{\hyperlink{pennfat__kernel_8c_a1951ec11865274b45144d6dd6f878692}{k\+\_\+read}} (int fd, int n, char \texorpdfstring{$\ast$}{*}buf)
\begin{DoxyCompactList}\small\item\em Read n bytes from the file referenced by fd. On return, k\+\_\+read returns the number of bytes read, 0 if EOF is reached, or a negative number on error. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{pennfat__kernel_8c_a580177591867f52c90932219a6c29e71}{extend\+\_\+fat}} (int start\+\_\+index, int empty\+\_\+fat\+\_\+index)
\begin{DoxyCompactList}\small\item\em Extend the fat region of the given file (marked by the {\ttfamily start\+\_\+index} ) by one block. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{pennfat__kernel_8c_a83562583c4bda73b3c02691374ed1655}{write\+\_\+one\+\_\+byte\+\_\+in\+\_\+while}} (int bytes\+\_\+left, int size, int true\+\_\+offset, int \texorpdfstring{$\ast$}{*}size\+\_\+increment, int \texorpdfstring{$\ast$}{*}bytes\+\_\+written, int \texorpdfstring{$\ast$}{*}current\+\_\+offset, const char \texorpdfstring{$\ast$}{*}str, uint16\+\_\+t first\+Block)
\item 
void \mbox{\hyperlink{pennfat__kernel_8c_a07773059737a331913ba55c458fbaccd}{update\+\_\+directory\+\_\+entry\+\_\+after\+\_\+write}} (struct \mbox{\hyperlink{structdirectory__entries}{directory\+\_\+entries}} \texorpdfstring{$\ast$}{*}curr\+\_\+de, char \texorpdfstring{$\ast$}{*}fname, int bytes\+\_\+written)
\item 
ssize\+\_\+t \mbox{\hyperlink{pennfat__kernel_8c_a79d2a9b65d0e04de358fe1a2cfa79baf}{k\+\_\+write}} (int fd, const char \texorpdfstring{$\ast$}{*}str, int n)
\begin{DoxyCompactList}\small\item\em Write n bytes of the string referenced by str to the file fd and increment the file pointer by n. On return, k\+\_\+write returns the number of bytes written, or a negative value on error. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{pennfat__kernel_8c_af7f9a41e9fb0fdf97403eff276990e1f}{k\+\_\+count\+\_\+fd\+\_\+num}} (const char \texorpdfstring{$\ast$}{*}name)
\begin{DoxyCompactList}\small\item\em Returns the number of currently open in the global\+\_\+fd\+\_\+table with the {\ttfamily name} as the fname. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{pennfat__kernel_8c_a9ecd38dc6f3a9721ab53ff9a815b5480}{k\+\_\+close}} (int fd)
\begin{DoxyCompactList}\small\item\em Close the file fd and return 0 on success, or a negative value on failure. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{pennfat__kernel_8c_ae8b44b3621ebb542bec49f73d19d2885}{k\+\_\+unlink}} (const char \texorpdfstring{$\ast$}{*}fname)
\begin{DoxyCompactList}\small\item\em Remove the file by freeing the FAT table and zeroing out previously existing data. \end{DoxyCompactList}\item 
off\+\_\+t \mbox{\hyperlink{pennfat__kernel_8c_a332b4729ef52b2a3132b1aea88fa5c96}{k\+\_\+lseek}} (int fd, int offset, int whence)
\begin{DoxyCompactList}\small\item\em Reposition the file pointer for fd to the offset relative to whence. Refer to lseek(2) for how whence interacts with the file offset. If the newly calculated offset is creater than the current size of the file, the file expands to match that offset with the newly allocated space filled with 0s. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{pennfat__kernel_8c_a4760215b7653953e799d8489ca88be8e}{generate\+\_\+permission}} (uint8\+\_\+t perm, char \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}permissions)
\item 
char \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{pennfat__kernel_8c_af2e67755671ac41b267522c63e52a7ba}{format\+Time}} (time\+\_\+t t)
\item 
int \mbox{\hyperlink{pennfat__kernel_8c_a8d29dec65e04c5f1fe04b09921dede89}{k\+\_\+ls}} (const char \texorpdfstring{$\ast$}{*}filename, int fd)
\begin{DoxyCompactList}\small\item\em List the file filename in the current directory. If filename is NULL, list all files in the current directory. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{pennfat__kernel_8c_abf487212da5b9d6ebceef678fa744ad9}{k\+\_\+update\+\_\+timestamp}} (const char \texorpdfstring{$\ast$}{*}source)
\begin{DoxyCompactList}\small\item\em Change the timestamp of the file to the current time. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{pennfat__kernel_8c_a85eace193c41193d1646af1a8b943200}{k\+\_\+rename}} (const char \texorpdfstring{$\ast$}{*}source, const char \texorpdfstring{$\ast$}{*}dest)
\begin{DoxyCompactList}\small\item\em Rename {\ttfamily source} to {\ttfamily dest}. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{pennfat__kernel_8c_ad4e9851dc3cbc61a9f8ffd36b94b9938}{k\+\_\+change\+\_\+mode}} (const char \texorpdfstring{$\ast$}{*}change, const char \texorpdfstring{$\ast$}{*}filename)
\begin{DoxyCompactList}\small\item\em Change file mode bits. \end{DoxyCompactList}\item 
char \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{pennfat__kernel_8c_a08194e0542962e4d980cd9278f33c7f5}{k\+\_\+read\+\_\+all}} (const char \texorpdfstring{$\ast$}{*}filename, int \texorpdfstring{$\ast$}{*}read\+\_\+num)
\begin{DoxyCompactList}\small\item\em Reads all contents from the file with the file name {\ttfamily filename}. Outputs the contents as well as update {\ttfamily read\+\_\+num} to the number of bytes read. \end{DoxyCompactList}\item 
char \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{pennfat__kernel_8c_af6d6a9bc81e4cf0788c8f1de39999c22}{k\+\_\+get\+\_\+fname\+\_\+from\+\_\+fd}} (int fd)
\begin{DoxyCompactList}\small\item\em Returns the filename for the given file descriptor number. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{pennfat__kernel_8c_a82daa98d4c392b4249bfbc975be22daa}{k\+\_\+cp\+\_\+within\+\_\+fat}} (char \texorpdfstring{$\ast$}{*}source, char \texorpdfstring{$\ast$}{*}dest)
\begin{DoxyCompactList}\small\item\em Copies the contents from {\ttfamily source} to {\ttfamily dest}. Both {\ttfamily source} and {\ttfamily dest} must be files within the PENNFAT system. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{pennfat__kernel_8c_aaad024bf5305fa73db8c92084f8a1df0}{k\+\_\+cp\+\_\+to\+\_\+host}} (char \texorpdfstring{$\ast$}{*}source, char \texorpdfstring{$\ast$}{*}host\+\_\+dest)
\begin{DoxyCompactList}\small\item\em Copies the contents from {\ttfamily source} to {\ttfamily host\+\_\+dest} {\ttfamily source} must be a file within the PENNFAT system. {\ttfamily host\+\_\+dest} is a host system file. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{pennfat__kernel_8c_a90de0cbbfd37f924016dd07d60d38853}{k\+\_\+cp\+\_\+from\+\_\+host}} (char \texorpdfstring{$\ast$}{*}host\+\_\+source, char \texorpdfstring{$\ast$}{*}dest)
\begin{DoxyCompactList}\small\item\em Copies the contents from {\ttfamily host\+\_\+source} to {\ttfamily dest}. {\ttfamily dest} must be a file within the PENNFAT system. {\ttfamily host\+\_\+source} is a host system file. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
uint16\+\_\+t \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{pennfat__kernel_8c_a0e52a1a113ded7f4787290edc22ad954}{fat}} = NULL
\begin{DoxyCompactList}\small\item\em Penn\+FAT filesystem that has been mounted to memory using the mmap(2). \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structfile__descriptor__st}{file\+\_\+descriptor\+\_\+st}} \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*} \mbox{\hyperlink{pennfat__kernel_8c_a07afa4cbf62f3ce8292a6ddbcb37c8fc}{global\+\_\+fd\+\_\+table}} = NULL
\begin{DoxyCompactList}\small\item\em Kernel level global file descriptor table that stores all file descriptor that has been created through out the program\textquotesingle{}s runtime. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{pennfat__kernel_8c_a64b57b29bcc87a7b1967c7d55e7d4212}{fs\+\_\+fd}} = -\/1
\begin{DoxyCompactList}\small\item\em File descriptor number (host system level) for the filesystem that has been mounted to the program. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{pennfat__kernel_8c_a70b27761c7d0bd5cd90f4fe47e569b94}{block\+\_\+size}} = 0
\begin{DoxyCompactList}\small\item\em Block size of the currently mounted filesystem that is defined during the mkfs process. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{pennfat__kernel_8c_a6a5f2839b4852a1e8b5c0b10ec6caa5b}{fat\+\_\+size}} = 0
\begin{DoxyCompactList}\small\item\em FAT region size of the currently mounted filesystem. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{pennfat__kernel_8c_af866bcf6c2272c2f6b1b7e5ad3a2e127}{num\+\_\+fat\+\_\+entries}} = 0
\begin{DoxyCompactList}\small\item\em Calculated value of the total number of FAT entries within the currently mounted filesystem. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{pennfat__kernel_8c_af69e180c878a9c8f4e45ec7dc25a062f}{data\+\_\+size}} = 0
\begin{DoxyCompactList}\small\item\em Calculated data region size of the currently mounted filesystem. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{pennfat__kernel_8c_ab5dda65dc446f15f9c0449ca2d9e82b1}{fd\+\_\+counter}} = 3
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\Hypertarget{pennfat__kernel_8c_a3fd2d5dba8f5f42be13d549b0e08a3ad}\label{pennfat__kernel_8c_a3fd2d5dba8f5f42be13d549b0e08a3ad} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!create\_directory\_entry@{create\_directory\_entry}}
\index{create\_directory\_entry@{create\_directory\_entry}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{create\_directory\_entry()}{create\_directory\_entry()}}
{\footnotesize\ttfamily struct \mbox{\hyperlink{structdirectory__entries}{directory\+\_\+entries}} \texorpdfstring{$\ast$}{*} create\+\_\+directory\+\_\+entry (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{name,  }\item[{uint32\+\_\+t}]{size,  }\item[{uint16\+\_\+t}]{first\+Block,  }\item[{uint8\+\_\+t}]{type,  }\item[{uint8\+\_\+t}]{perm,  }\item[{time\+\_\+t}]{mtime }\end{DoxyParamCaption})}



Creates a new \doxylink{structdirectory__entries}{directory\+\_\+entries} struct, initialized with the values provided by the parameters. For more information of the parameters, refer to struct \doxylink{structdirectory__entries}{directory\+\_\+entries}. 


\begin{DoxyParams}{Parameters}
{\em name} & Name of the file. \\
\hline
{\em size} & Size of the current file. \\
\hline
{\em first\+Block} & First FAT block number. \\
\hline
{\em type} & Type of the file. \\
\hline
{\em perm} & Permission of the file. \\
\hline
{\em mtime} & Last modified time.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A newly created \doxylink{structdirectory__entries}{directory\+\_\+entries} struct. NULL on memory allocation error. 
\end{DoxyReturn}
\Hypertarget{pennfat__kernel_8c_a25ad4d01d5ade905b2bfce04910a5c0d}\label{pennfat__kernel_8c_a25ad4d01d5ade905b2bfce04910a5c0d} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!create\_file\_descriptor@{create\_file\_descriptor}}
\index{create\_file\_descriptor@{create\_file\_descriptor}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{create\_file\_descriptor()}{create\_file\_descriptor()}}
{\footnotesize\ttfamily struct \mbox{\hyperlink{structfile__descriptor__st}{file\+\_\+descriptor\+\_\+st}} \texorpdfstring{$\ast$}{*} create\+\_\+file\+\_\+descriptor (\begin{DoxyParamCaption}\item[{int}]{fd,  }\item[{char \texorpdfstring{$\ast$}{*}}]{fname,  }\item[{int}]{mode,  }\item[{int}]{offset }\end{DoxyParamCaption})}



Creates a new \doxylink{structfile__descriptor__st}{file\+\_\+descriptor\+\_\+st} struct, initialized with the values provided by the parameters. For more information of the parameters, refer to struct \doxylink{structfile__descriptor__st}{file\+\_\+descriptor\+\_\+st}. 


\begin{DoxyParams}{Parameters}
{\em fd} & File descriptor number. \\
\hline
{\em fname} & Name of the file. \\
\hline
{\em mode} & Either F\+\_\+\+WRITE, F\+\_\+\+READ, F\+\_\+\+APPEND. \\
\hline
{\em offset} & Offset to the start of the file.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A newly created \doxylink{structfile__descriptor__st}{file\+\_\+descriptor\+\_\+st} struct. NULL on memory allocation error. 
\end{DoxyReturn}
\Hypertarget{pennfat__kernel_8c_a78d95341bbd2b21ed69dd341ff47669f}\label{pennfat__kernel_8c_a78d95341bbd2b21ed69dd341ff47669f} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!does\_file\_exist@{does\_file\_exist}}
\index{does\_file\_exist@{does\_file\_exist}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{does\_file\_exist()}{does\_file\_exist()}}
{\footnotesize\ttfamily struct \mbox{\hyperlink{structdirectory__entries}{directory\+\_\+entries}} \texorpdfstring{$\ast$}{*} does\+\_\+file\+\_\+exist (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{fname }\end{DoxyParamCaption})}



helper that traverses root directory block by block to check if fname file exists return\+: the directory entry struct with name fname (NULL if not found) also moves fs\+\_\+fd to the end of the root directory 


\begin{DoxyParams}{Parameters}
{\em fname} & Name of the file that we want to check. \\
\hline
\end{DoxyParams}
\Hypertarget{pennfat__kernel_8c_a8434cdce67b1512300f44ed38497c22a}\label{pennfat__kernel_8c_a8434cdce67b1512300f44ed38497c22a} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!does\_file\_exist2@{does\_file\_exist2}}
\index{does\_file\_exist2@{does\_file\_exist2}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{does\_file\_exist2()}{does\_file\_exist2()}}
{\footnotesize\ttfamily off\+\_\+t does\+\_\+file\+\_\+exist2 (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{fname }\end{DoxyParamCaption})}



Helper function that given a files name, it outputs the offset to the directory entry or negative number if the file isn\textquotesingle{}t found. 


\begin{DoxyParams}{Parameters}
{\em fname} & Name of the file that we want to check. \\
\hline
\end{DoxyParams}
\Hypertarget{pennfat__kernel_8c_a580177591867f52c90932219a6c29e71}\label{pennfat__kernel_8c_a580177591867f52c90932219a6c29e71} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!extend\_fat@{extend\_fat}}
\index{extend\_fat@{extend\_fat}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{extend\_fat()}{extend\_fat()}}
{\footnotesize\ttfamily void extend\+\_\+fat (\begin{DoxyParamCaption}\item[{int}]{start\+\_\+index,  }\item[{int}]{empty\+\_\+fat\+\_\+index }\end{DoxyParamCaption})}



Extend the fat region of the given file (marked by the {\ttfamily start\+\_\+index} ) by one block. 


\begin{DoxyParams}{Parameters}
{\em start\+\_\+index} & Start fat index for the given file. \\
\hline
{\em empty\+\_\+fat\+\_\+index} & The first empty index of the current FAT table. Should be calculated using \doxylink{pennfat__kernel_8h_addbc36d23ce41b02cb1508bf85ca24e2}{get\+\_\+first\+\_\+empty\+\_\+fat\+\_\+index()}. \\
\hline
\end{DoxyParams}
\Hypertarget{pennfat__kernel_8c_af2e67755671ac41b267522c63e52a7ba}\label{pennfat__kernel_8c_af2e67755671ac41b267522c63e52a7ba} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!formatTime@{formatTime}}
\index{formatTime@{formatTime}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{formatTime()}{formatTime()}}
{\footnotesize\ttfamily char \texorpdfstring{$\ast$}{*} format\+Time (\begin{DoxyParamCaption}\item[{time\+\_\+t}]{t }\end{DoxyParamCaption})}

\Hypertarget{pennfat__kernel_8c_a4760215b7653953e799d8489ca88be8e}\label{pennfat__kernel_8c_a4760215b7653953e799d8489ca88be8e} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!generate\_permission@{generate\_permission}}
\index{generate\_permission@{generate\_permission}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{generate\_permission()}{generate\_permission()}}
{\footnotesize\ttfamily void generate\+\_\+permission (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{perm,  }\item[{char \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{permissions }\end{DoxyParamCaption})}

\Hypertarget{pennfat__kernel_8c_abe5ffc180d9fc063efc7127d14378b54}\label{pennfat__kernel_8c_abe5ffc180d9fc063efc7127d14378b54} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!get\_file\_descriptor@{get\_file\_descriptor}}
\index{get\_file\_descriptor@{get\_file\_descriptor}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{get\_file\_descriptor()}{get\_file\_descriptor()}}
{\footnotesize\ttfamily struct \mbox{\hyperlink{structfile__descriptor__st}{file\+\_\+descriptor\+\_\+st}} \texorpdfstring{$\ast$}{*} get\+\_\+file\+\_\+descriptor (\begin{DoxyParamCaption}\item[{int}]{fd }\end{DoxyParamCaption})}



Return the file descriptor struct for the given file descriptor number. 


\begin{DoxyParams}{Parameters}
{\em fd} & File descriptor number. \\
\hline
\end{DoxyParams}
\Hypertarget{pennfat__kernel_8c_addbc36d23ce41b02cb1508bf85ca24e2}\label{pennfat__kernel_8c_addbc36d23ce41b02cb1508bf85ca24e2} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!get\_first\_empty\_fat\_index@{get\_first\_empty\_fat\_index}}
\index{get\_first\_empty\_fat\_index@{get\_first\_empty\_fat\_index}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{get\_first\_empty\_fat\_index()}{get\_first\_empty\_fat\_index()}}
{\footnotesize\ttfamily int get\+\_\+first\+\_\+empty\+\_\+fat\+\_\+index (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Finds and returns the first empty fat index marked as 0x0000. 

\begin{DoxyReturn}{Returns}
first empty fat index. 
\end{DoxyReturn}
\Hypertarget{pennfat__kernel_8c_ada30dc78055b7b113ff2dac9aabe4eb3}\label{pennfat__kernel_8c_ada30dc78055b7b113ff2dac9aabe4eb3} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!is\_file\_name\_valid@{is\_file\_name\_valid}}
\index{is\_file\_name\_valid@{is\_file\_name\_valid}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{is\_file\_name\_valid()}{is\_file\_name\_valid()}}
{\footnotesize\ttfamily bool is\+\_\+file\+\_\+name\+\_\+valid (\begin{DoxyParamCaption}\item[{char \texorpdfstring{$\ast$}{*}}]{name }\end{DoxyParamCaption})}



Checks whether the filename follows the POSIX standard. 


\begin{DoxyParams}{Parameters}
{\em name} & Filename.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
True if valid. False otherwise. 
\end{DoxyReturn}
\Hypertarget{pennfat__kernel_8c_ad4e9851dc3cbc61a9f8ffd36b94b9938}\label{pennfat__kernel_8c_ad4e9851dc3cbc61a9f8ffd36b94b9938} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!k\_change\_mode@{k\_change\_mode}}
\index{k\_change\_mode@{k\_change\_mode}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{k\_change\_mode()}{k\_change\_mode()}}
{\footnotesize\ttfamily int k\+\_\+change\+\_\+mode (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{change,  }\item[{const char \texorpdfstring{$\ast$}{*}}]{filename }\end{DoxyParamCaption})}



Change file mode bits. 

The operator + causes the selected file mode bits to be added to the existing file mode bits of each file; -\/ causes them to be removed.


\begin{DoxyParams}{Parameters}
{\em change} & String that determines how the bits are modified. \\
\hline
{\em filename} & Name of the file.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 on success. Negative number on failure. 
\end{DoxyReturn}
\Hypertarget{pennfat__kernel_8c_a9ecd38dc6f3a9721ab53ff9a815b5480}\label{pennfat__kernel_8c_a9ecd38dc6f3a9721ab53ff9a815b5480} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!k\_close@{k\_close}}
\index{k\_close@{k\_close}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{k\_close()}{k\_close()}}
{\footnotesize\ttfamily int k\+\_\+close (\begin{DoxyParamCaption}\item[{int}]{fd }\end{DoxyParamCaption})}



Close the file fd and return 0 on success, or a negative value on failure. 


\begin{DoxyParams}{Parameters}
{\em fd} & File descriptor number that needs to be closed \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success, or a negative value on failure. 
\end{DoxyReturn}
\Hypertarget{pennfat__kernel_8c_af7f9a41e9fb0fdf97403eff276990e1f}\label{pennfat__kernel_8c_af7f9a41e9fb0fdf97403eff276990e1f} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!k\_count\_fd\_num@{k\_count\_fd\_num}}
\index{k\_count\_fd\_num@{k\_count\_fd\_num}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{k\_count\_fd\_num()}{k\_count\_fd\_num()}}
{\footnotesize\ttfamily int k\+\_\+count\+\_\+fd\+\_\+num (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{name }\end{DoxyParamCaption})}



Returns the number of currently open in the global\+\_\+fd\+\_\+table with the {\ttfamily name} as the fname. 


\begin{DoxyParams}{Parameters}
{\em name} & Name of the file that we want to check. \\
\hline
\end{DoxyParams}
\Hypertarget{pennfat__kernel_8c_a90de0cbbfd37f924016dd07d60d38853}\label{pennfat__kernel_8c_a90de0cbbfd37f924016dd07d60d38853} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!k\_cp\_from\_host@{k\_cp\_from\_host}}
\index{k\_cp\_from\_host@{k\_cp\_from\_host}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{k\_cp\_from\_host()}{k\_cp\_from\_host()}}
{\footnotesize\ttfamily int k\+\_\+cp\+\_\+from\+\_\+host (\begin{DoxyParamCaption}\item[{char \texorpdfstring{$\ast$}{*}}]{host\+\_\+source,  }\item[{char \texorpdfstring{$\ast$}{*}}]{dest }\end{DoxyParamCaption})}



Copies the contents from {\ttfamily host\+\_\+source} to {\ttfamily dest}. {\ttfamily dest} must be a file within the PENNFAT system. {\ttfamily host\+\_\+source} is a host system file. 

{\ttfamily host\+\_\+source} must exist. If {\ttfamily dest} does not exist, it will be newly created.


\begin{DoxyParams}{Parameters}
{\em host\+\_\+source} & File name of source. Must be a host system file. \\
\hline
{\em dest} & File name of dest. Must be a Penn\+FAT file.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 on success. Negative number on failure. 
\end{DoxyReturn}
\Hypertarget{pennfat__kernel_8c_aaad024bf5305fa73db8c92084f8a1df0}\label{pennfat__kernel_8c_aaad024bf5305fa73db8c92084f8a1df0} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!k\_cp\_to\_host@{k\_cp\_to\_host}}
\index{k\_cp\_to\_host@{k\_cp\_to\_host}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{k\_cp\_to\_host()}{k\_cp\_to\_host()}}
{\footnotesize\ttfamily int k\+\_\+cp\+\_\+to\+\_\+host (\begin{DoxyParamCaption}\item[{char \texorpdfstring{$\ast$}{*}}]{source,  }\item[{char \texorpdfstring{$\ast$}{*}}]{host\+\_\+dest }\end{DoxyParamCaption})}



Copies the contents from {\ttfamily source} to {\ttfamily host\+\_\+dest} {\ttfamily source} must be a file within the PENNFAT system. {\ttfamily host\+\_\+dest} is a host system file. 

{\ttfamily source} must exist. If {\ttfamily host\+\_\+dest} does not exist, it will be newly created.


\begin{DoxyParams}{Parameters}
{\em source} & File name of source. Must be a Penn\+FAT file. \\
\hline
{\em host\+\_\+dest} & File name of dest. Must be a host system file.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 on success. Negative number on failure. 
\end{DoxyReturn}
\Hypertarget{pennfat__kernel_8c_a82daa98d4c392b4249bfbc975be22daa}\label{pennfat__kernel_8c_a82daa98d4c392b4249bfbc975be22daa} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!k\_cp\_within\_fat@{k\_cp\_within\_fat}}
\index{k\_cp\_within\_fat@{k\_cp\_within\_fat}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{k\_cp\_within\_fat()}{k\_cp\_within\_fat()}}
{\footnotesize\ttfamily int k\+\_\+cp\+\_\+within\+\_\+fat (\begin{DoxyParamCaption}\item[{char \texorpdfstring{$\ast$}{*}}]{source,  }\item[{char \texorpdfstring{$\ast$}{*}}]{dest }\end{DoxyParamCaption})}



Copies the contents from {\ttfamily source} to {\ttfamily dest}. Both {\ttfamily source} and {\ttfamily dest} must be files within the PENNFAT system. 

{\ttfamily source} must exist. If {\ttfamily dest} does not exist, it will be newly created.


\begin{DoxyParams}{Parameters}
{\em source} & File name of source. Must be a Penn\+FAT file. \\
\hline
{\em dest} & File name of dest. Must be a Penn\+FAT file.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 on success. Negative number on failure. 
\end{DoxyReturn}
\Hypertarget{pennfat__kernel_8c_af6d6a9bc81e4cf0788c8f1de39999c22}\label{pennfat__kernel_8c_af6d6a9bc81e4cf0788c8f1de39999c22} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!k\_get\_fname\_from\_fd@{k\_get\_fname\_from\_fd}}
\index{k\_get\_fname\_from\_fd@{k\_get\_fname\_from\_fd}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{k\_get\_fname\_from\_fd()}{k\_get\_fname\_from\_fd()}}
{\footnotesize\ttfamily char \texorpdfstring{$\ast$}{*} k\+\_\+get\+\_\+fname\+\_\+from\+\_\+fd (\begin{DoxyParamCaption}\item[{int}]{fd }\end{DoxyParamCaption})}



Returns the filename for the given file descriptor number. 


\begin{DoxyParams}{Parameters}
{\em fd} & The file descriptor number.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The file name of the {\ttfamily fd} . NULL is {\ttfamily fd} is invalid. 
\end{DoxyReturn}
\Hypertarget{pennfat__kernel_8c_a8d29dec65e04c5f1fe04b09921dede89}\label{pennfat__kernel_8c_a8d29dec65e04c5f1fe04b09921dede89} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!k\_ls@{k\_ls}}
\index{k\_ls@{k\_ls}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{k\_ls()}{k\_ls()}}
{\footnotesize\ttfamily int k\+\_\+ls (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{filename,  }\item[{int}]{fd }\end{DoxyParamCaption})}



List the file filename in the current directory. If filename is NULL, list all files in the current directory. 

Similar to posix ls.


\begin{DoxyParams}{Parameters}
{\em filename} & Optional parameter. If specified, ls data for the specified file is printed \\
\hline
{\em fd} & The file descriptor you want to write the result of k\+\_\+ls to\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 on success, negative value on failure 
\end{DoxyReturn}
\Hypertarget{pennfat__kernel_8c_a332b4729ef52b2a3132b1aea88fa5c96}\label{pennfat__kernel_8c_a332b4729ef52b2a3132b1aea88fa5c96} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!k\_lseek@{k\_lseek}}
\index{k\_lseek@{k\_lseek}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{k\_lseek()}{k\_lseek()}}
{\footnotesize\ttfamily off\+\_\+t k\+\_\+lseek (\begin{DoxyParamCaption}\item[{int}]{fd,  }\item[{int}]{offset,  }\item[{int}]{whence }\end{DoxyParamCaption})}



Reposition the file pointer for fd to the offset relative to whence. Refer to lseek(2) for how whence interacts with the file offset. If the newly calculated offset is creater than the current size of the file, the file expands to match that offset with the newly allocated space filled with 0s. 


\begin{DoxyParams}{Parameters}
{\em fd} & File descriptor number \\
\hline
{\em offset} & Offset value \\
\hline
{\em whence} & F\+\_\+\+SEEK\+\_\+\+SET, F\+\_\+\+SEEK\+\_\+\+CUR, and F\+\_\+\+SEEK\+\_\+\+END. Follows the lseek(2) whence mode.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
off\+\_\+t Newly calculated offset for {\ttfamily fd} 
\end{DoxyReturn}
\Hypertarget{pennfat__kernel_8c_a4d2cf4232cddee738996ca9ad83ea56f}\label{pennfat__kernel_8c_a4d2cf4232cddee738996ca9ad83ea56f} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!k\_open@{k\_open}}
\index{k\_open@{k\_open}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{k\_open()}{k\_open()}}
{\footnotesize\ttfamily int k\+\_\+open (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{fname,  }\item[{int}]{mode }\end{DoxyParamCaption})}



Open file name {\ttfamily fname} with the mode {\ttfamily mode}, and return a file descriptor to that file. 

This function opens a file specified by the file name {\ttfamily fname} in the mode specified by {\ttfamily mode} and returns a file descriptor associated with the open file that can be used for subsequent file operations.


\begin{DoxyParams}{Parameters}
{\em fname} & The name of the file to open. See POSIX standard for allowed names. \\
\hline
{\em mode} & The mode with which to open the file. This should specify the access mode (e.\+g., read, write) and other flags as defined by the operating system. Allowed modes are\+: write ({\ttfamily F\+\_\+\+WRITE}), read ({\ttfamily F\+\_\+\+READ}), and append ({\ttfamily F\+\_\+\+APPEND}).\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int A non-\/negative file descriptor on success, or -\/1 on error and {\ttfamily errno} set.
\end{DoxyReturn}
\begin{DoxyNote}{Note}
The {\ttfamily mode} parameter may only be {\ttfamily F\+\_\+\+WRITE}, {\ttfamily F\+\_\+\+READ}, or {\ttfamily F\+\_\+\+APPEND}. Note that despite their names, write and append support both reading and writing. {\ttfamily F\+\_\+\+APPEND}\textquotesingle{}s file pointer will point to the end of the file rather than the beginning. Both {\ttfamily F\+\_\+\+WRITE} and {\ttfamily F\+\_\+\+APPEND} will create the named file if it does not already exist.
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
\href{https://www.ibm.com/docs/en/zos/3.1.0?topic=locales-posix-portable-file-name-character-set}{\texttt{ https\+://www.\+ibm.\+com/docs/en/zos/3.\+1.\+0?topic=locales-\/posix-\/portable-\/file-\/name-\/character-\/set}}
\end{DoxySeeAlso}
Possible values of {\ttfamily errno} are\+:
\begin{DoxyItemize}
\item {\ttfamily EACCES} \+: // need to fill these in, will expand as further progress
\item {\ttfamily ENAMETOOLONG} \+: 
\end{DoxyItemize}\Hypertarget{pennfat__kernel_8c_a1951ec11865274b45144d6dd6f878692}\label{pennfat__kernel_8c_a1951ec11865274b45144d6dd6f878692} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!k\_read@{k\_read}}
\index{k\_read@{k\_read}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{k\_read()}{k\_read()}}
{\footnotesize\ttfamily ssize\+\_\+t k\+\_\+read (\begin{DoxyParamCaption}\item[{int}]{fd,  }\item[{int}]{n,  }\item[{char \texorpdfstring{$\ast$}{*}}]{buf }\end{DoxyParamCaption})}



Read n bytes from the file referenced by fd. On return, k\+\_\+read returns the number of bytes read, 0 if EOF is reached, or a negative number on error. 


\begin{DoxyParams}{Parameters}
{\em fd} & File descriptor number we are reading from \\
\hline
{\em n} & Number of bytes we are reading from {\ttfamily fd} \\
\hline
{\em buf} & Buffer where we store the read value\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
ssize\+\_\+t the number of bytes read, 0 if EOF is reached, or a negative number on error 
\end{DoxyReturn}
\Hypertarget{pennfat__kernel_8c_a08194e0542962e4d980cd9278f33c7f5}\label{pennfat__kernel_8c_a08194e0542962e4d980cd9278f33c7f5} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!k\_read\_all@{k\_read\_all}}
\index{k\_read\_all@{k\_read\_all}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{k\_read\_all()}{k\_read\_all()}}
{\footnotesize\ttfamily char \texorpdfstring{$\ast$}{*} k\+\_\+read\+\_\+all (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{filename,  }\item[{int \texorpdfstring{$\ast$}{*}}]{read\+\_\+num }\end{DoxyParamCaption})}



Reads all contents from the file with the file name {\ttfamily filename}. Outputs the contents as well as update {\ttfamily read\+\_\+num} to the number of bytes read. 


\begin{DoxyParams}{Parameters}
{\em filename} & Name of the file we want to read from. \\
\hline
{\em read\+\_\+num} & Pointer to an integer variable that will store the number of bytes read.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
All contents of {\ttfamily filename} in char\texorpdfstring{$\ast$}{*} format. 
\end{DoxyReturn}
\Hypertarget{pennfat__kernel_8c_a85eace193c41193d1646af1a8b943200}\label{pennfat__kernel_8c_a85eace193c41193d1646af1a8b943200} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!k\_rename@{k\_rename}}
\index{k\_rename@{k\_rename}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{k\_rename()}{k\_rename()}}
{\footnotesize\ttfamily int k\+\_\+rename (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{source,  }\item[{const char \texorpdfstring{$\ast$}{*}}]{dest }\end{DoxyParamCaption})}



Rename {\ttfamily source} to {\ttfamily dest}. 


\begin{DoxyParams}{Parameters}
{\em source} & Source file name. \\
\hline
{\em dest} & Destination file name.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 on success. Negative number on failure. 
\end{DoxyReturn}
\Hypertarget{pennfat__kernel_8c_ae8b44b3621ebb542bec49f73d19d2885}\label{pennfat__kernel_8c_ae8b44b3621ebb542bec49f73d19d2885} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!k\_unlink@{k\_unlink}}
\index{k\_unlink@{k\_unlink}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{k\_unlink()}{k\_unlink()}}
{\footnotesize\ttfamily int k\+\_\+unlink (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{fname }\end{DoxyParamCaption})}



Remove the file by freeing the FAT table and zeroing out previously existing data. 


\begin{DoxyParams}{Parameters}
{\em fname} & Name of the file we want to remove.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 on success. Negative value of failure. 
\end{DoxyReturn}
\Hypertarget{pennfat__kernel_8c_abf487212da5b9d6ebceef678fa744ad9}\label{pennfat__kernel_8c_abf487212da5b9d6ebceef678fa744ad9} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!k\_update\_timestamp@{k\_update\_timestamp}}
\index{k\_update\_timestamp@{k\_update\_timestamp}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{k\_update\_timestamp()}{k\_update\_timestamp()}}
{\footnotesize\ttfamily int k\+\_\+update\+\_\+timestamp (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{source }\end{DoxyParamCaption})}



Change the timestamp of the file to the current time. 


\begin{DoxyParams}{Parameters}
{\em source} & Source file name.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 on success. Negative number on failure. 
\end{DoxyReturn}
\Hypertarget{pennfat__kernel_8c_a79d2a9b65d0e04de358fe1a2cfa79baf}\label{pennfat__kernel_8c_a79d2a9b65d0e04de358fe1a2cfa79baf} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!k\_write@{k\_write}}
\index{k\_write@{k\_write}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{k\_write()}{k\_write()}}
{\footnotesize\ttfamily ssize\+\_\+t k\+\_\+write (\begin{DoxyParamCaption}\item[{int}]{fd,  }\item[{const char \texorpdfstring{$\ast$}{*}}]{str,  }\item[{int}]{n }\end{DoxyParamCaption})}



Write n bytes of the string referenced by str to the file fd and increment the file pointer by n. On return, k\+\_\+write returns the number of bytes written, or a negative value on error. 


\begin{DoxyParams}{Parameters}
{\em fd} & File descriptor number we are reading to \\
\hline
{\em str} & Provided string we want to write to {\ttfamily fd} \\
\hline
{\em n} & Number of bytes we are writing\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
ssize\+\_\+t number of bytes written, or a negative value on error. 
\end{DoxyReturn}
\Hypertarget{pennfat__kernel_8c_a2d501c304eeba5035c83c1e2a4aec4fb}\label{pennfat__kernel_8c_a2d501c304eeba5035c83c1e2a4aec4fb} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!lseek\_to\_root\_directory@{lseek\_to\_root\_directory}}
\index{lseek\_to\_root\_directory@{lseek\_to\_root\_directory}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{lseek\_to\_root\_directory()}{lseek\_to\_root\_directory()}}
{\footnotesize\ttfamily void lseek\+\_\+to\+\_\+root\+\_\+directory (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



lseek the file system\textquotesingle{}s offset to the start of the root directory. 

\Hypertarget{pennfat__kernel_8c_a6532ad36b852dd09d641bcaac2642b9b}\label{pennfat__kernel_8c_a6532ad36b852dd09d641bcaac2642b9b} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!move\_to\_open\_de@{move\_to\_open\_de}}
\index{move\_to\_open\_de@{move\_to\_open\_de}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{move\_to\_open\_de()}{move\_to\_open\_de()}}
{\footnotesize\ttfamily void move\+\_\+to\+\_\+open\+\_\+de (\begin{DoxyParamCaption}\item[{bool}]{found }\end{DoxyParamCaption})}



Change the offset to the fs\+\_\+fd to the first open directory entry. 


\begin{DoxyParams}{Parameters}
{\em found} & \\
\hline
\end{DoxyParams}
\Hypertarget{pennfat__kernel_8c_a07773059737a331913ba55c458fbaccd}\label{pennfat__kernel_8c_a07773059737a331913ba55c458fbaccd} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!update\_directory\_entry\_after\_write@{update\_directory\_entry\_after\_write}}
\index{update\_directory\_entry\_after\_write@{update\_directory\_entry\_after\_write}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{update\_directory\_entry\_after\_write()}{update\_directory\_entry\_after\_write()}}
{\footnotesize\ttfamily void update\+\_\+directory\+\_\+entry\+\_\+after\+\_\+write (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structdirectory__entries}{directory\+\_\+entries}} \texorpdfstring{$\ast$}{*}}]{curr\+\_\+de,  }\item[{char \texorpdfstring{$\ast$}{*}}]{fname,  }\item[{int}]{bytes\+\_\+written }\end{DoxyParamCaption})}

\Hypertarget{pennfat__kernel_8c_a83562583c4bda73b3c02691374ed1655}\label{pennfat__kernel_8c_a83562583c4bda73b3c02691374ed1655} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!write\_one\_byte\_in\_while@{write\_one\_byte\_in\_while}}
\index{write\_one\_byte\_in\_while@{write\_one\_byte\_in\_while}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{write\_one\_byte\_in\_while()}{write\_one\_byte\_in\_while()}}
{\footnotesize\ttfamily void write\+\_\+one\+\_\+byte\+\_\+in\+\_\+while (\begin{DoxyParamCaption}\item[{int}]{bytes\+\_\+left,  }\item[{int}]{size,  }\item[{int}]{true\+\_\+offset,  }\item[{int \texorpdfstring{$\ast$}{*}}]{size\+\_\+increment,  }\item[{int \texorpdfstring{$\ast$}{*}}]{bytes\+\_\+written,  }\item[{int \texorpdfstring{$\ast$}{*}}]{current\+\_\+offset,  }\item[{const char \texorpdfstring{$\ast$}{*}}]{str,  }\item[{uint16\+\_\+t}]{first\+Block }\end{DoxyParamCaption})}

\Hypertarget{pennfat__kernel_8c_a2620b333236d4362345a3eaa15479aa5}\label{pennfat__kernel_8c_a2620b333236d4362345a3eaa15479aa5} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!zero\_out\_helper@{zero\_out\_helper}}
\index{zero\_out\_helper@{zero\_out\_helper}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{zero\_out\_helper()}{zero\_out\_helper()}}
{\footnotesize\ttfamily void zero\+\_\+out\+\_\+helper (\begin{DoxyParamCaption}\item[{int}]{curr }\end{DoxyParamCaption})}



\doxysubsection{Variable Documentation}
\Hypertarget{pennfat__kernel_8c_a70b27761c7d0bd5cd90f4fe47e569b94}\label{pennfat__kernel_8c_a70b27761c7d0bd5cd90f4fe47e569b94} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!block\_size@{block\_size}}
\index{block\_size@{block\_size}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{block\_size}{block\_size}}
{\footnotesize\ttfamily int block\+\_\+size = 0}



Block size of the currently mounted filesystem that is defined during the mkfs process. 

\Hypertarget{pennfat__kernel_8c_af69e180c878a9c8f4e45ec7dc25a062f}\label{pennfat__kernel_8c_af69e180c878a9c8f4e45ec7dc25a062f} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!data\_size@{data\_size}}
\index{data\_size@{data\_size}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{data\_size}{data\_size}}
{\footnotesize\ttfamily int data\+\_\+size = 0}



Calculated data region size of the currently mounted filesystem. 

\Hypertarget{pennfat__kernel_8c_a0e52a1a113ded7f4787290edc22ad954}\label{pennfat__kernel_8c_a0e52a1a113ded7f4787290edc22ad954} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!fat@{fat}}
\index{fat@{fat}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{fat}{fat}}
{\footnotesize\ttfamily uint16\+\_\+t\texorpdfstring{$\ast$}{*} fat = NULL}



Penn\+FAT filesystem that has been mounted to memory using the mmap(2). 

\Hypertarget{pennfat__kernel_8c_a6a5f2839b4852a1e8b5c0b10ec6caa5b}\label{pennfat__kernel_8c_a6a5f2839b4852a1e8b5c0b10ec6caa5b} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!fat\_size@{fat\_size}}
\index{fat\_size@{fat\_size}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{fat\_size}{fat\_size}}
{\footnotesize\ttfamily int fat\+\_\+size = 0}



FAT region size of the currently mounted filesystem. 

\Hypertarget{pennfat__kernel_8c_ab5dda65dc446f15f9c0449ca2d9e82b1}\label{pennfat__kernel_8c_ab5dda65dc446f15f9c0449ca2d9e82b1} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!fd\_counter@{fd\_counter}}
\index{fd\_counter@{fd\_counter}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{fd\_counter}{fd\_counter}}
{\footnotesize\ttfamily int fd\+\_\+counter = 3}

\Hypertarget{pennfat__kernel_8c_a64b57b29bcc87a7b1967c7d55e7d4212}\label{pennfat__kernel_8c_a64b57b29bcc87a7b1967c7d55e7d4212} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!fs\_fd@{fs\_fd}}
\index{fs\_fd@{fs\_fd}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{fs\_fd}{fs\_fd}}
{\footnotesize\ttfamily int fs\+\_\+fd = -\/1}



File descriptor number (host system level) for the filesystem that has been mounted to the program. 

\Hypertarget{pennfat__kernel_8c_a07afa4cbf62f3ce8292a6ddbcb37c8fc}\label{pennfat__kernel_8c_a07afa4cbf62f3ce8292a6ddbcb37c8fc} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!global\_fd\_table@{global\_fd\_table}}
\index{global\_fd\_table@{global\_fd\_table}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{global\_fd\_table}{global\_fd\_table}}
{\footnotesize\ttfamily struct \mbox{\hyperlink{structfile__descriptor__st}{file\+\_\+descriptor\+\_\+st}}\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*} global\+\_\+fd\+\_\+table = NULL}



Kernel level global file descriptor table that stores all file descriptor that has been created through out the program\textquotesingle{}s runtime. 

\Hypertarget{pennfat__kernel_8c_af866bcf6c2272c2f6b1b7e5ad3a2e127}\label{pennfat__kernel_8c_af866bcf6c2272c2f6b1b7e5ad3a2e127} 
\index{pennfat\_kernel.c@{pennfat\_kernel.c}!num\_fat\_entries@{num\_fat\_entries}}
\index{num\_fat\_entries@{num\_fat\_entries}!pennfat\_kernel.c@{pennfat\_kernel.c}}
\doxysubsubsection{\texorpdfstring{num\_fat\_entries}{num\_fat\_entries}}
{\footnotesize\ttfamily int num\+\_\+fat\+\_\+entries = 0}



Calculated value of the total number of FAT entries within the currently mounted filesystem. 

